ржЦрзБржм ржнрж╛рж▓рзЛ ржкрзНрж░рж╢рзНржи ЁЯСН
ржПржЦрж╛ржирзЗржЗ **Spring magic** ржмрзЛржЭрж╛ ржпрж╛рзЯред

рждрзБржорж┐ ржЬрж┐ржЬрзНржЮрзЗрж╕ ржХрж░ржЫрзЛ:

> **ржПржЗ Filter ржЯрж╛ register рж╣рж▓рзЛ ржХрзАржнрж╛ржмрзЗ?
> Spring ржХрзАржнрж╛ржмрзЗ ржЬрж╛ржирж▓рзЛ ржпрзЗ тАЬржПржЯрж╛ ржЖржЧрзЗ ржЪрж╛рж▓рж╛рждрзЗ рж╣ржмрзЗтАЭ?**

ржЪрж▓рзЛ **ржПржХржжржо ржнрж┐рждрж░рзЗрж░ ржорзЗржХрж╛ржирж┐ржЬржо** ржзрж╛ржкрзЗ ржзрж╛ржкрзЗ ржмрзБржЭрж┐ред

---

# ЁЯза Short answer (ржЖржЧрзЗ)

ЁЯСЙ `@Component` ржерж╛ржХрж╛рж░ ржХрж╛рж░ржгрзЗ
ЁЯСЙ Spring **startup-ржП** ржПржЗ class-ржЯрж╛ detect ржХрж░рзЗ
ЁЯСЙ рждрж╛рж░ржкрж░ **Servlet Filter рж╣рж┐рж╕рзЗржмрзЗ auto-register** ржХрж░рзЗ
ЁЯСЙ рждрж╛ржЗ request ржЖрж╕рж▓рзЗржЗ **Controller-ржПрж░ ржЖржЧрзЗржЗ** ржЪрж╛рж▓рж╛рзЯ

ржПржЦржи ржмрж┐рж╕рзНрждрж╛рж░рж┐ржд ЁЯСЗ

---

# 1я╕ПтГг Spring startup-ржП ржХрзА рж╣рзЯ?

Spring Boot start рж╣рж▓рзЗ ржПржЗ ржХрж╛ржЬржЧрзБрж▓рзЛ рж╣рзЯ:

```
1. Component scan
2. Bean create
3. Web infrastructure setup
4. Filter chain build
5. App ready
```

---

# 2я╕ПтГг `@Component` ржХрзА ржХрж╛ржЬ ржХрж░рзЗ?

```java
@Component
public class MyFilter implements Filter { }
```

ржПрж░ ржорж╛ржирзЗ:

> тАЬржПржЗ class-ржЯрж╛ Spring container-ржПрж░ beanтАЭ

Startup-ржП Spring ржХрж░рзЗ:

```
@ComponentScan тЖТ
MyFilter found тЖТ
Bean registered in ApplicationContext
```

---

# 3я╕ПтГг Spring ржХрзАржнрж╛ржмрзЗ ржмрзБржЭрж▓рзЛ ржПржЯрж╛ Filter?

ржХрж╛рж░ржг рждрзЛржорж╛рж░ class:

```java
implements javax.servlet.Filter
```

Spring internally check ржХрж░рзЗ:

> тЭУ тАЬржПржЗ bean ржХрж┐ Filter interface implement ржХрж░рзЗржЫрзЗ?тАЭ

тЬФ Yes тЖТ **Servlet Filter рж╣рж┐рж╕рзЗржмрзЗ treat ржХрж░рзЛ**

---

# 4я╕ПтГг Auto-registration ржХрж┐ржнрж╛ржмрзЗ рж╣рзЯ?

Spring Boot-ржПрж░ ржнрзЗрждрж░рзЗ ржЖржЫрзЗ:

```
ServletContextInitializerBeans
```

ржПржЗ component:

* рж╕ржм bean scan ржХрж░рзЗ
* ржпрзЗржЧрзБрж▓рзЛ `Filter` implement ржХрж░рзЗ
* рж╕рзЗржЧрзБрж▓рзЛржХрзЗ **Servlet container (Tomcat)**-ржП register ржХрж░рзЗ

ЁЯСЙ рждрзБржорж┐ ржХрж┐ржЫрзБ рж▓рж┐ржЦрзЛ ржирж╛
ЁЯСЙ Spring ржирж┐ржЬрзЗржЗ ржХрж░рзЗ

---

# 5я╕ПтГг Servlet container (Tomcat) ржХрзА ржХрж░рзЗ?

Tomcat-ржПрж░ request flow:

```
Incoming Request
 тЖТ Servlet Filters
 тЖТ DispatcherServlet
 тЖТ Controller
```

ржпрзЗрж╣рзЗрждрзБ рждрзЛржорж╛рж░ Filter Tomcat-ржП register рж╣рзЯрзЗржЫрзЗ:

ЁЯСЙ **рж╕ржм request-ржПрж░ ржЖржЧрзЗржЗ ржПржЯрж╛ ржЪрж╛рж▓рзБ рж╣рзЯ**

---

# 6я╕ПтГг ржХрзЗржи Controller call рж╣рзЯ ржирж╛ ржпржжрж┐ block ржХрж░рзЛ?

ржПржЗ рж▓рж╛ржЗржирзЗрж░ ржЬржирзНржп:

```java
chain.doFilter(request, response);
```

### ржпржжрж┐ рждрзБржорж┐ ржПржЯрж╛ call ржирж╛ ржХрж░рзЛ:

```java
return; // chain.doFilter ржирж╛ ржбрж╛ржХрж╛
```

рждрж╛рж╣рж▓рзЗ flow ржерзЗржорзЗ ржпрж╛рзЯ:

```
Request
 тЖТ Filter
 тЖТ тЭМ STOP
```

ЁЯСЙ DispatcherServlet / Controller ржЖрж░ ржбрж╛ржХрзЗ ржирж╛

---

# 7я╕ПтГг Visual flow (ржоржирзЗ рж░рж╛ржЦрж╛рж░ ржорждрзЛ)

```
Browser
 тЖУ
Tomcat
 тЖУ
MyFilter.doFilter()   тЖР ржПржЦрж╛ржирзЗ block ржХрж░рж╛ ржпрж╛рзЯ
 тЖУ
Spring Security Filters
 тЖУ
DispatcherServlet
 тЖУ
Controller
```

---

# 8я╕ПтГг Explicit register ржХрж░рж▓рзЗ ржХрж┐ржнрж╛ржмрзЗ рж╣рзЯ? (alternative)

ржпржжрж┐ `@Component` ржирж╛ ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзЛ:

```java
@Bean
public FilterRegistrationBean<MyFilter> myFilter() {
    FilterRegistrationBean<MyFilter> reg =
        new FilterRegistrationBean<>();

    reg.setFilter(new MyFilter());
    reg.setOrder(1);

    return reg;
}
```

ЁЯСЙ ржПржЯрж╛ **manual registration**

Banking apps-ржП ржЕржирзЗржХ рж╕ржорзЯ order control ржХрж░рж╛рж░ ржЬржирзНржп ржПржЯрж╛ ржмрзНржпржмрж╣рж╛рж░ рж╣рзЯред

---

# 9я╕ПтГг Bank-style rule ЁЯПж

| Situation           | Method                   |
| ------------------- | ------------------------ |
| Simple global check | `@Component Filter`      |
| Order important     | `FilterRegistrationBean` |
| Security logic      | Spring Security Filter   |
| Business rule       | Service / AOP            |

---

# ЁЯза ржПржХ рж▓рж╛ржЗржирзЗ ржоржирзЗ рж░рж╛ржЦрзЛ

> **`@Component` + `implements Filter` ржерж╛ржХрж▓рзЗржЗ Spring Boot startup-ржП Filter auto-register ржХрж░рзЗ ржПржмржВ Controller-ржПрж░ ржЖржЧрзЗржЗ ржЪрж╛рж▓рж╛рзЯред**

---

## ЁЯФЬ Next (ржпрзЗржЯрж╛ ржХрж░рж▓рзЗ ржмрзЛржЭрж╛ ржЖрж░рзЛ clear рж╣ржмрзЗ)

1я╕ПтГг Filter order ржХрж┐ржнрж╛ржмрзЗ control ржХрж░рж╛ рж╣рзЯ
2я╕ПтГг Spring Security filter vs custom filter
3я╕ПтГг Debug ржХрж░рзЗ filter execution ржжрзЗржЦрж╛
4я╕ПтГг Filter vs Interceptor practical difference

ЁЯСЙ рж╢рзБржзрзБ ржирж╛ржорзНржмрж╛рж░ ржмрж▓рзЛ ЁЯСН
