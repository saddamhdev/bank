ржЖржЪрзНржЫрж╛ ЁЯСН
рждрзБржорж┐ ржмрж▓рждрзЗ ржЪрж╛ржУ тАФ **тАЬржПржЗ рзкржнрж╛ржмрзЗ ржХрзАржнрж╛ржмрзЗ checklist ржЖржХрж╛рж░рзЗ ржмрж╕рж╛ржирзЛ ржпрж╛рзЯ, ржХрзЛржерж╛рзЯ рж▓рж┐ржЦрждрзЗ рж╣рзЯ, ржЖрж░ ржХрж┐ржнрж╛ржмрзЗ check ржХрж░ржмрзЛ?тАЭ**
ржирж┐ржЪрзЗ **ржПржХржжржо clear checklist** ржжрж┐рж▓рж╛ржоред

---

# тЬЕ Spring-ржП тАЬржЖржЧрзЗ check ржХрж░рзЛтАЭ тАФ **рзкржнрж╛ржмрзЗ Checklist**

---

## 1я╕ПтГг **Servlet Filter** (рж╕ржмржЪрзЗрзЯрзЗ ржЖржЧрзЗ)

### тЬФ ржХрзЛржерж╛рзЯ рж▓рж┐ржЦржмрзЗ

* Class file
* `@Component`
* `implements Filter`

```java
@Component
public class MyFilter implements Filter {
  public void doFilter(...) {
    // CHECK HERE
    chain.doFilter(request, response);
  }
}
```

### тЬФ ржХрзА check ржХрж░ржмрзЗ

* Header ржЖржЫрзЗ ржХрж┐ржирж╛
* IP block
* Device detect
* Simple JWT presence

### тЬФ ржХрж┐ржнрж╛ржмрзЗ verify ржХрж░ржмрзЗ

* `System.out.println()` / log
* Controller ржирж╛ ржврзБржХрж▓рзЗ filter ржХрж╛ржЬ ржХрж░ржЫрзЗ

---

## 2я╕ПтГг **Spring Security (AuthN + AuthZ)**

### тЬФ ржХрзЛржерж╛рзЯ рж▓рж┐ржЦржмрзЗ

* `SecurityConfig` тЖТ `SecurityFilterChain`

```java
http.authorizeHttpRequests(auth -> auth
  .requestMatchers("/auth/login").permitAll()
  .anyRequest().authenticated()
);
```

### тЬФ ржХрзА check ржХрж░ржмрзЗ

* Login required ржХрж┐ржирж╛
* Role / Authority
* JWT validity

### тЬФ ржХрж┐ржнрж╛ржмрзЗ verify ржХрж░ржмрзЗ

* Token ржЫрж╛рзЬрж╛ тЖТ **401**
* Wrong role тЖТ **403**
* Valid token тЖТ Controller hit

---

## 3я╕ПтГг **HandlerInterceptor** (Controller-ржПрж░ ржарж┐ржХ ржЖржЧрзЗ)

### тЬФ ржХрзЛржерж╛рзЯ рж▓рж┐ржЦржмрзЗ

* Interceptor class
* `WebMvcConfigurer` ржжрж┐рзЯрзЗ register

```java
public boolean preHandle(...) {
  // CHECK HERE
  return true; // false ржжрж┐рж▓рзЗ controller ржпрж╛ржмрзЗ ржирж╛
}
```

### тЬФ ржХрзА check ржХрж░ржмрзЗ

* Channel header
* Custom rules
* Request metadata

### тЬФ ржХрж┐ржнрж╛ржмрзЗ verify ржХрж░ржмрзЗ

* `preHandle` log
* `return false` ржжрж┐рж▓рзЗ controller call рж╣рзЯ ржирж╛

---

## 4я╕ПтГг **Method-level (AOP / @PreAuthorize)**

### тЬФ ржХрзЛржерж╛рзЯ рж▓рж┐ржЦржмрзЗ

* Controller / Service method

```java
@PreAuthorize("hasRole('ADMIN')")
public void adminTask() {}
```

### тЬФ ржХрзА check ржХрж░ржмрзЗ

* Fine-grained permission
* Admin-only / Teller-only

### тЬФ ржХрж┐ржнрж╛ржмрзЗ verify ржХрж░ржмрзЗ

* Role ржЫрж╛рзЬрж╛ тЖТ **403**
* Role ржерж╛ржХрж▓рзЗ тЖТ method execute

---

# ЁЯза ржПржХ ржиржЬрж░рзЗ Checklist (copy рж░рж╛ржЦрзЛ)

```
[ ] Filter тЖТ request ржЖрж╕рждрзЗржЗ check
[ ] Security тЖТ login / role check
[ ] Interceptor тЖТ controller-ржПрж░ ржЖржЧрзЗ rule
[ ] @PreAuthorize тЖТ method call-ржПрж░ ржЖржЧрзЗ
```

---

# ЁЯПж Bank-style Golden Rule

* ЁЯФР **Security / Identity** тЖТ Filter + Spring Security
* ЁЯУЛ **Request rules** тЖТ Interceptor
* ЁЯза **Business permission** тЖТ @PreAuthorize
* тЭМ Controller-ржП security рж▓рж┐ржЦржмрзЗ ржирж╛

---

## ЁЯОп ржпржжрж┐ ржЪрж╛ржУ next step

1я╕ПтГг ржПржЗ рзкржЯрж╛рж░ **execution order diagram**
2я╕ПтГг Real banking example (login тЖТ transfer)
3я╕ПтГг ржХрзЛржиржЯрж╛ ржХрзЛржерж╛рзЯ ржмрзНржпржмрж╣рж╛рж░ ржХрж░ржмрзЗ decision chart
4я╕ПтГг Live debug ржХрж░рзЗ ржжрзЗржЦрж╛

ЁЯСЙ ржирж╛ржорзНржмрж╛рж░ ржмрж▓рзЛ, рж╕рж╛ржерзЗ рж╕рж╛ржерзЗ рж╢рзБрж░рзБ ржХрж░ржмрзЛ ЁЯСН
