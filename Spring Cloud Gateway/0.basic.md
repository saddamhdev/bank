ржЪрж▓ ржПржХржжржо **ржнрж┐рждрж░ ржерзЗржХрзЗ ржмрж╛ржЗрж░рзЗ** ржмрзЛржЭрж╛ржЗтАФ**Spring Cloud Gateway (SCG)** ржЖрж╕рж▓рзЗ ржХрзАржнрж╛ржмрзЗ ржХрж╛ржЬ ржХрж░рзЗ ЁЯзаЁЯЪА
(ржПржЯрж╛ ржмрзБржЭрж▓рзЗ gateway ржЖрж░ black-box ржоржирзЗ рж╣ржмрзЗ ржирж╛)

Spring Cloud Gateway рж╣рж▓рзЛ **reactive, non-blocking API Gateway**тАФржпрзЗржЯрж╛ microservices-ржПрж░ рж╕рж╛ржоржирзЗ ржмрж╕рзЗ **proxy + control layer** рж╣рж┐рж╕рзЗржмрзЗ ржХрж╛ржЬ ржХрж░рзЗред

---

## ЁЯФБ High-level Working Flow

```
Client Request
     тЖУ
Netty Web Server
     тЖУ
Route Matching (Predicate)
     тЖУ
Pre Filters
     тЖУ
Proxy to Backend Service
     тЖУ
Post Filters
     тЖУ
Client Response
```

---

## ЁЯзй Core Building Blocks (рж╕ржмржЪрзЗрзЯрзЗ ржЧрзБрж░рзБрждрзНржмржкрзВрж░рзНржг)

### 1я╕ПтГг Route

Route ржорж╛ржирзЗ:
ЁЯСЙ **ржХрзЛржи request тЖТ ржХрзЛржи service-ржП ржпрж╛ржмрзЗ**

```yaml
spring:
  cloud:
    gateway:
      routes:
        - id: user-service
          uri: lb://USER-SERVICE
          predicates:
            - Path=/api/users/**
```

ржПржЦрж╛ржирзЗ:

* `id` тЖТ route ржирж╛ржо
* `uri` тЖТ backend service
* `predicates` тЖТ condition

---

### 2я╕ПтГг Predicate (Route Matching Rule)

Predicate ржарж┐ржХ ржХрж░рзЗ **ржПржЗ route ржЯрж╛ рж▓рж╛ржЧржмрзЗ ржХрж┐ржирж╛**

Common predicates:

* `Path`
* `Method`
* `Header`
* `Query`
* `Host`

```yaml
predicates:
  - Path=/api/users/**
  - Method=GET
```

ЁЯСЙ Request match ржирж╛ ржХрж░рж▓рзЗ тЖТ route apply рж╣ржмрзЗ ржирж╛

---

### 3я╕ПтГг Filter (Magic Happens Here тЬи)

Filters рж╣рж▓рзЛ Gateway-ржПрж░ **brain**ред

#### ЁЯФ╣ Pre Filter (request ржпрж╛ржУрзЯрж╛рж░ ржЖржЧрзЗ)

* JWT verify
* Header add/remove
* Rate limit
* Logging

#### ЁЯФ╣ Post Filter (response ржЖрж╕рж╛рж░ ржкрж░рзЗ)

* Response modify
* Logging
* Metrics

```yaml
filters:
  - AddRequestHeader=X-Request-From, Gateway
  - RewritePath=/api/(?<segment>.*), /${segment}
```

---

## ЁЯФР Authentication Flow (JWT Example)

```
Client
  тЖУ (JWT)
Gateway
  тФЬтФА Validate token
  тФЬтФА Reject if invalid
  тФФтФА Forward if valid
        тЖУ
   Backend Service
```

Backend service ржЖрж░ token validate ржХрж░рзЗ ржирж╛
ЁЯСЙ **Gateway does it once**

---

## тЪЩя╕П Internal Engine (Under the Hood)

SCG built on:

* **Spring WebFlux**
* **Project Reactor**
* **Netty (non-blocking)**

ржорж╛ржирзЗ:

* тЭМ Thread-per-request ржирж╛
* тЬЕ Event-loop based
* тЬЕ High concurrency (banking-grade)

---

## ЁЯза Request Lifecycle (Deep View)

1. Client hits Gateway
2. Netty accepts request
3. Gateway Handler Mapping routes list scan ржХрж░рзЗ
4. Predicate match рж╣рзЯ
5. Filter chain рждрзИрж░рж┐ рж╣рзЯ
6. Pre-filters execute
7. Request proxy рж╣рзЯ backend-ржП
8. Response ржЖрж╕рзЗ
9. Post-filters execute
10. Response client-ржП return

---

## ЁЯФД Load Balancing (Service Discovery)

```yaml
uri: lb://ORDER-SERVICE
```

ржПрж░ ржорж╛ржирзЗ:

* Gateway calls **Eureka**
* Finds healthy instances
* Load-balance ржХрж░рзЗ

---

## ЁЯЫС Circuit Breaker (Fault Protection)

```yaml
filters:
  - name: CircuitBreaker
    args:
      name: userCB
      fallbackUri: forward:/fallback/users
```

ЁЯСЙ Backend down рж╣рж▓рзЗ:

* Gateway fallback response ржжрзЗрзЯ
* System alive ржерж╛ржХрзЗ

---

## ЁЯПж Real Enterprise Use (Banking Style)

Gateway handles:

* OAuth2 / mTLS
* Rate limit per client
* Request signing
* Audit logging (Splunk)
* Header sanitization

Backend focuses on:

* Business logic only ЁЯТ╝

---

## ЁЯза ржПржХ рж▓рж╛ржЗржирзЗ ржоржирзЗ рж░рж╛ржЦрзЛ

> **Spring Cloud Gateway = Reactive reverse proxy + security + routing + control for microservices**

---

## рждрзБржорж┐ ржпржжрж┐ ржЪрж╛ржУ, next level ржП ржпрзЗрждрзЗ ржкрж╛рж░рж┐:

* ЁЯФ╣ Custom GlobalFilter рж▓рж┐ржЦрзЗ ржжрзЗржЦрж╛ржЗ
* ЁЯФ╣ JWT auth full implementation
* ЁЯФ╣ Rate limit with Redis
* ЁЯФ╣ Gateway vs NGINX vs Kong
* ЁЯФ╣ Banking-grade gateway architecture

ржмрж▓рж▓рзЗржЗ ржкрж░рзЗрж░ рж▓рзЗрзЯрж╛рж░ ржЦрзБрж▓рзЗ ржжрж┐ржЗ ЁЯФУЁЯФе
