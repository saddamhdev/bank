à¦­à¦¾à¦²à§‹ ğŸ‘ à¦à¦–à¦¨ à¦ªà§à¦°à§‹à¦Ÿà¦¾ `appCaptureClient` à¦à¦° à¦¨à¦¿à¦šà§‡ nested à¦¹à§Ÿà§‡à¦›à§‡à¥¤
à¦à¦Ÿà¦¾ à¦®à¦¾à¦¨à§‡ à¦à¦‡ configuration à¦Ÿà¦¾ **à¦à¦•à¦Ÿà¦¾ specific outbound client (App Capture Service)** à¦à¦° à¦œà¦¨à§à¦¯à¥¤

---

# ğŸ” Structure Breakdown

```yaml
appCaptureClient:
  env: MR
  oauth2:
    resource-uri: JPMC:URI:RS-89893-149650-daapinewaccounts-UAT
    enabled: true
    client:
      client-id: PC-89893-H061801-338413-UAT
      credential: cyberark.credential.local.username-ADVH061801;password-7nj5Ngh#
      access-token-uri: https://idaaatg2.jpmorganchase.com/adfs/oauth2/token
```

---

# ğŸ”¹ 1ï¸âƒ£ appCaptureClient

à¦à¦Ÿà¦¾ à¦¤à§‹à¦®à¦¾à¦° **external service client config block**à¥¤

à¦®à¦¾à¦¨à§‡:
ğŸ‘‰ à¦¤à§‹à¦®à¦¾à¦° Spring Boot service â†’ â€œApp Captureâ€ à¦¨à¦¾à¦®à§‡ à¦à¦•à¦Ÿà¦¾ downstream service call à¦•à¦°à¦¬à§‡à¥¤

---

# ğŸ”¹ 2ï¸âƒ£ env: MR

Environment tag
Used for:

* Logging
* Header tagging
* Dynamic routing
* Multi-region config

Example:

```java
log.info("Calling AppCapture in env: {}", env);
```

---

# ğŸ”¹ 3ï¸âƒ£ oauth2.enabled: true

If `true` â†’
Call à¦•à¦°à¦¾à¦° à¦†à¦—à§‡ OAuth2 token à¦¨à¦¿à¦¤à§‡ à¦¹à¦¬à§‡à¥¤

If `false` â†’
Direct call (no token)

---

# ğŸ”¹ 4ï¸âƒ£ resource-uri

OAuth2 audience / resource server ID

Token request à¦à¦° à¦¸à¦®à§Ÿ à¦à¦Ÿà¦¾ audience à¦¹à¦¿à¦¸à§‡à¦¬à§‡ match à¦•à¦°à¦¤à§‡ à¦¹à§Ÿà¥¤

Enterprise banking system à¦ à¦à¦Ÿà¦¾ à¦–à§à¦¬ commonà¥¤

---

# ğŸ”¹ 5ï¸âƒ£ client-id

OAuth2 registered client ID
Identity Server (ADFS) à¦ pre-registered à¦¥à¦¾à¦•à§‡à¥¤

---

# ğŸ”¹ 6ï¸âƒ£ credential

âš ï¸ Sensitive
Looks like CyberArk-managed credential reference.

Structure:

```
username-ADVH061801
password-7nj5Ngh#
```

Production best practice:

* Vault
* CyberArk injection
* ENV variable
* Never hardcode

---

# ğŸ”¹ 7ï¸âƒ£ access-token-uri

Token endpoint:

```
POST https://idaaatg2.jpmorganchase.com/adfs/oauth2/token
```

Grant type usually:

```
client_credentials
```

---

# ğŸš€ Full Runtime Flow

1ï¸âƒ£ Spring Boot starts
2ï¸âƒ£ Config bind à¦¹à§Ÿ
3ï¸âƒ£ Service call à¦•à¦°à¦¾à¦° à¦¸à¦®à§Ÿ:

```
if(enabled){
   call token endpoint
   get access token
}
```

4ï¸âƒ£ Downstream call:

```
Authorization: Bearer eyJhbGciOi...
```

---

# ğŸ¦ Banking Architecture Level Meaning

à¦à¦Ÿà¦¾ basically:

âœ” Enterprise OAuth2 client config
âœ” ADFS based token generation
âœ” Secure downstream API call
âœ” UAT environment setup

---

# ğŸ§  Spring Boot Binding Example

## POJO

```java
@Component
@ConfigurationProperties(prefix = "app-capture-client")
public class AppCaptureClientProperties {

    private String env;
    private OAuth2 oauth2;

    // getters setters

    public static class OAuth2 {
        private String resourceUri;
        private boolean enabled;
        private Client client;

        // getters setters
    }

    public static class Client {
        private String clientId;
        private String credential;
        private String accessTokenUri;

        // getters setters
    }
}
```

---

# ğŸ” IMPORTANT (Security Upgrade Suggestion)

Instead of:

```yaml
credential: cyberark.credential.local.username-ADVH061801;password-7nj5Ngh#
```

Use:

```yaml
credential: ${APP_CAPTURE_CREDENTIAL}
```

And inject from:

```
ENV
Vault
CyberArk
```

---

# ğŸ¯ Summary

à¦à¦‡ block à¦à¦° à¦•à¦¾à¦œ:

ğŸ‘‰ à¦¤à§‹à¦®à¦¾à¦° service à¦¯à§‡à¦¨ secure à¦­à¦¾à¦¬à§‡ App Capture API call à¦•à¦°à¦¤à§‡ à¦ªà¦¾à¦°à§‡
ğŸ‘‰ OAuth2 token à¦¸à¦‚à¦—à§à¦°à¦¹ à¦•à¦°à§‡
ğŸ‘‰ Proper audience à¦¸à¦¹ request à¦ªà¦¾à¦ à¦¾à§Ÿ

---

à¦¤à§à¦®à¦¿ à¦•à¦¿ à¦šà¦¾à¦“ à¦à¦–à¦¨:

* ğŸ”¥ Full working WebClient OAuth2 code?
* ğŸ” Banking-grade secure version?
* ğŸš€ Gateway filter version?
* ğŸ”„ Token caching strategy?

à¦¬à¦²à¦²à§‡à¦‡ next level enterprise implementation à¦¦à§‡à¦–à¦¾à¦‡ ğŸ˜
