ржнрж╛рж▓рзЛ ЁЯСН ржПржЦржи ржПржЯрж╛ security block тАФ ржПржмржВ ржПржЯрж╛ ржЖржЧрзЗрж░ OAuth2 discussion ржПрж░ рж╕рж╛ржерзЗ relatedред

рждрзЛржорж╛рж░ YAML:

```yaml
moneta:
  security:
    adfs:
      enabled: false
      provider:
        url: https://idaadg2.jpmorganchase.com/adfs
      protected-resource-uri: JPMC:URI:RS-89893-158633-assistedgettingstartedexp-QA
```

ржПржЯрж╛ basically **ADFS based authentication configuration**ред

---

# ЁЯза ржкрзНрж░ржержорзЗ ржмрзБржЭрж┐ ADFS ржХрзА?

ADFS = **Active Directory Federation Services**

ЁЯСЙ Microsoft based Identity Provider
ЁЯСЙ Enterprise / Banking environment ржП widely used
ЁЯСЙ OAuth2 / OpenID Connect token issue ржХрж░рзЗ

---

# ЁЯФН Line by Line Explanation

---

## ЁЯФ╣ moneta.security.adfs.enabled: false

ржорж╛ржирзЗ:

ADFS security currently OFF

ржпржжрж┐ true рж╣рзЯ:

* Application ADFS token validate ржХрж░ржмрзЗ
* Incoming request token verify ржХрж░ржмрзЗ

---

## ЁЯФ╣ provider.url

```yaml
url: https://idaadg2.jpmorganchase.com/adfs
```

ржПржЯрж╛ рж╣рж▓рзЛ Identity Provider base URLред

ржПржЦрж╛ржи ржерзЗржХрзЗ:

* Token issue рж╣рзЯ
* Metadata ржкрж╛ржУрзЯрж╛ ржпрж╛рзЯ
* Public key ржкрж╛ржУрзЯрж╛ ржпрж╛рзЯ

---

## ЁЯФ╣ protected-resource-uri

```yaml
protected-resource-uri: JPMC:URI:RS-89893-158633-assistedgettingstartedexp-QA
```

ржПржЯрж╛ resource identifierред

Token ржПрж░ ржнрж┐рждрж░рзЗ ржПржХржЯрж╛ claim ржерж╛ржХрзЗ:

```
aud (audience)
```

Spring check ржХрж░ржмрзЗ:

```
token.aud == protected-resource-uri ?
```

ржорзНржпрж╛ржЪ ржирж╛ ржХрж░рж▓рзЗ request reject ржХрж░ржмрзЗред

---

# ЁЯФе ржПржЦржи Gateway Context ржП ржПржЯрж╛ ржХрзА ржХрж░ржЫрзЗ?

ржПржЯрж╛ inbound securityред

ржЖржЧрзЗрж░ config ржЫрж┐рж▓ outbound (Gateway тЖТ Service)
ржПржЯрж╛ inbound (Client тЖТ Gateway)

---

# ЁЯФР Flow ржпржжрж┐ enabled = true рж╣рзЯ

```
Client тЖТ Gateway
         |
         |  Bearer token validate ржХрж░ржмрзЗ
         тЖУ
   Check token signature (ADFS public key)
   Check audience matches protected-resource-uri
   If valid тЖТ allow
   If invalid тЖТ 401
```

---

# ЁЯзй Difference: Outbound vs Inbound

| Type                    | Purpose                                 |
| ----------------------- | --------------------------------------- |
| appCaptureClient.oauth2 | Gateway token ржирж┐рзЯрзЗ downstream call ржХрж░ржмрзЗ |
| moneta.security.adfs    | Gateway incoming token validate ржХрж░ржмрзЗ    |

---

# ЁЯПж Enterprise Architecture View

Normally:

Client тЖТ Gateway (token validate)
Gateway тЖТ Downstream (new token issue ржмрж╛ propagate)

Large banking system ржП:

* ADFS central identity
* Every service protected
* Audience specific resource URI

---

# ЁЯОп ржПржХ рж▓рж╛ржЗржирзЗ

ЁЯСЙ ржПржЗ block Gateway ржХрзЗ ржмрж▓рзЗ: тАЬADFS ржжрж┐рзЯрзЗ incoming request token validate ржХрж░рзЛредтАЭ

---

# ЁЯШО Saddam тАУ рждрзЛржорж╛рж░ ржЬржирзНржп ржЧрзБрж░рзБрждрзНржмржкрзВрж░рзНржг

рждрзБржорж┐ ржпрзЗрж╣рзЗрждрзБ:

* Gateway
* OAuth2
* Enterprise style architecture

рждрзЛржорж╛рж░ system ржП ржжрзБржЯрзЛ security layer ржерж╛ржХрждрзЗ ржкрж╛рж░рзЗ:

1я╕ПтГг Inbound validation
2я╕ПтГг Outbound service authentication

---

ржЪрж╛ржУ ржХрж┐ ржЖржорж┐ explain ржХрж░рж┐:

ЁЯФе Full gateway security flow diagram?
ЁЯЪА How Spring Security validate ADFS JWT?
ЁЯФР How resource-uri audience check works internally?
ЁЯза Production-grade gateway security config example?

ржмрж▓рж▓рзЗржЗ deep explain ржХрж░ржмрзЛ ЁЯШО
